# Copyright (c) 2021 LG Electronics
# SPDX-License-Identifier: Apache-2.0
[tox]
envlist = test_run
skipdist = true

[testenv]
install_command = pip install {opts} {packages}
allowlist_externals = cat
                      ls
setenv =
  PYTHONPATH=.

[flake8]
max-line-length = 130
exclude = .tox/*

[pytest]
filterwarnings = ignore::DeprecationWarning
norecursedirs = test_result/*

[testenv:test_run]
commands =
  # Test - downloading source
  fosslight_download  -s "https://github.com/LGE-OSS/example" -t test_git/
  ls test_git/
  fosslight_download -s "https://pypi.org/project/fosslight-dependency/3.0.5/" -t test_wget -d test_logs
  fosslight_download -s "https://www.npmjs.com/package/json-schema/v/0.3.0" -t test_wget -d test_logs
  fosslight_download -s "https://mvnrepository.com/artifact/com.fasterxml.jackson.core/jackson-databind/2.12.2" -t test_wget -d test_logs
  fosslight_download -s "https://pub.dev/packages/file/versions/5.2.1" -t test_wget -d test_logs
  ls test_wget/

[testenv:release]
deps =
  -r{toxinidir}/requirements-dev.txt
wheel = true
commands =
  # Test - downloading source
  python tests/test_download.py
  ls test_result/download
  # Test - check PEP8
  pytest -v --flake8
